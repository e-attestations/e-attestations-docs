(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{180:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/EA_Graph_Security_Get_JWT_010-8db96c39562c91273de2735bf91c9662.png"},80:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return s}));var a=n(2),i=n(6),r=(n(0),n(93)),o={id:"s-1-jwt",title:"Authentication & Authorization",sidebar_label:"Authentication & Authorization"},c={unversionedId:"s-1-jwt",id:"s-1-jwt",isDocsHomePage:!1,title:"Authentication & Authorization",description:"Principles",source:"@site/docs/s-1-jwt.mdx",slug:"/s-1-jwt",permalink:"/docs/s-1-jwt",version:"current",sidebar_label:"Authentication & Authorization",sidebar:"docs",previous:{title:"Environments",permalink:"/docs/b-2-environments"},next:{title:"Authentication URLs",permalink:"/docs/s-7-urls"}},l=[{value:"Principles",id:"principles",children:[]},{value:"Credentials",id:"credentials",children:[]},{value:"Obtain a JSON Web Token",id:"obtain-a-json-web-token",children:[]},{value:"Environments",id:"environments",children:[]},{value:"You should use the refresh token too",id:"you-should-use-the-refresh-token-too",children:[]},{value:"Keep in mind that, the JWT ...",id:"keep-in-mind-that-the-jwt-",children:[]}],b={rightToc:l};function s(e){var t=e.components,o=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},b,o,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h2",{id:"principles"},"Principles"),Object(r.b)("p",null,"The e-Attestations REST API uses ",Object(r.b)("strong",{parentName:"p"},"[OpenID Connect (OIDC)]"," (",Object(r.b)("a",Object(a.a)({parentName:"strong"},{href:"https://openid.net/connect/"}),"https://openid.net/connect/"),")")," to identify and authenticate clients."),Object(r.b)("p",null,"Any request to the API is verified thus must include a valid JWT (",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://jwt.io/"}),"Json Web Token"),")."),Object(r.b)("p",null,"This must be sent in the ",Object(r.b)("inlineCode",{parentName:"p"},"Authorization")," header (see examples below)."),Object(r.b)("p",null,"If the ",Object(r.b)("inlineCode",{parentName:"p"},"Authorization")," header is not completed and valid, the request will be considered as not authenticated (HTTP code 401)."),Object(r.b)("p",null,"If any alteration of the token happens (IP address change is one of them) you'll receive HTTP code 403."),Object(r.b)("p",null,"More information on OpenID Connect and JWT on:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"https://openid.net/connect/"}),"https://openid.net/connect/")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"https://jwt.io/"}),"https://jwt.io/"))),Object(r.b)("h2",{id:"credentials"},"Credentials"),Object(r.b)("p",null,"The security model use a standard Header ",Object(r.b)("inlineCode",{parentName:"p"},"Authorization: Bearer <JWT>"),"model."),Object(r.b)("p",null,"But you need credenials in order to obtain a JWT."),Object(r.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"}),Object(r.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})))),"caution")),Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"Your credentials have to be issued at ",Object(r.b)("strong",null,"your request via a techDesk ticket")," sent and after activation of your subscription by your account manager."),Object(r.b)("p",{parentName:"div"},"Please send an email to ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"mailto:api@eattestationscom.zohodesk.eu"}),"api@eattestationscom.zohodesk.eu")))),Object(r.b)("h2",{id:"obtain-a-json-web-token"},"Obtain a JSON Web Token"),Object(r.b)("p",null,"Get a JWT token is based on a POST type request with user and password and some additional parameters to the authentication server."),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Parameter"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Mandatory"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Value"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Description"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("strong",{parentName:"td"},"client_id")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"true"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"'ea-api-edge'"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The name of the API")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("strong",{parentName:"td"},"grant_type")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"true"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"'password'"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The authentication model")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("strong",{parentName:"td"},"username")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"true"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The username given by e-Attestations")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("strong",{parentName:"td"},"password")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"true"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"The password given by e-Attestations")))),Object(r.b)("p",null,"You must send a request in ",Object(r.b)("inlineCode",{parentName:"p"},"application/x-www-form-urlencoded")," Content-Type header format with the following parameters (all mandatory):"),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"Obtain a JWT")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sh"}),"curl --request POST 'https://auth.test-e-attestations.com/auth/realms/eat_realm/protocol/openid-connect/token' \\\n--data-urlencode 'grant_type=password' \\\n--data-urlencode 'client_id=ea-api-edge' \\\n--data-urlencode 'username=<your user>' \\\n--data-urlencode 'password=<your password>' \\\n--data-urlencode 'Content-Type=application/json'\n")),Object(r.b)("p",null,"The authentication server will return a JSON word in which it is necessary to preserve 'access_token'."),Object(r.b)("p",null,Object(r.b)("img",{alt:"auth illustration",src:n(180).default})),Object(r.b)("p",null,"Credentials are verified by the auth server which send back a JWT (JSON Web Token) that user have to keep in ordre to use it for all subsequent requests to the API."),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"Example of the receive message")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n    "access_token":"eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI0V19kYjFzUmpISTc3SGc0SkRWclVLQXpaQlBnZjlpY2ZDcU5vQUxOZWhNIn0.eyJqdGkiOiI0ZGExNjE1NC04ZjQyLTQyNzQtOTM4Ny0wOGJiODk4MmE3MTMiLCJleHAiOjE1NTQyOTgyNTgsIm5iZiI6MCwiaWF0IjoxNTU0Mjk2NDU4LCJpc3MiOiJodHRwczovL2F1dGguZGV2LWUtYXR0ZXN0YXRpb25zLmNvbS9hdXRoL3JlYWxtcy9lYXRfcmVhbG0iLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYzg0OGFiYmItYTIyOC00MmMxLWFkNzAtYjJiMDEwYzhlODUxIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZWEtYXBpLWVkZ2UiLCJhdXRoX3RpbWUiOjAsInNlc3Npb25fc3RhdGUiOiI5YmEzYWFmNC0zYjU0LTQ5ZTctOTJiMC0xOTkwMGQxNWE5ZWIiLCJhY3IiOqsdqsdsdqsdqsdsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIiwiQURNSU4iLCJVU0VSIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiYWNjb3VudF9pZHMiOiIxMTg0NjYiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6IlZpbmNlbnQgREFHT1VSWSIsInByZWZlcnJlZF91c2VybmFtZSI6InYuZGFnb3VyeUBlLWF0dGVzdGF0aW9ucy5jb20iLCJnaXZlbl9uYW1lIjoiVmluY2VudCIsImZhbWlseV9uYW1lIjoiREFHT1VSWSIsImVtYWlsIjoidi5kYWdvdXJ5QGUtYXR0ZXN0YXRpb25zLmNvbSJ9.c-smWPif1YT9dKicAAJSsNwI-xCtZWV-r6QqYFSvkgHhPsgHc0gDLenMfQBgYPN_0jKW7FBJmse7fgAB4dnrqCOGM33cQ2wfYi37aXlDqz8l_aFamkEslGnKxw9QDOYSMQz52dD34yXQZGl0OxXE01PAquqKUEtnVG0Rz2SAB0qU5tAqsdqsdsd-rKpCYwKb_6-WwH2xN1B9lgLahZexprPvH25OXUcPJ0GSXCASpnSMxR3ziiv9AtX3R48rT4T_LTLlrKblT_cdZS-Z_uGgzP0pxT9yfqxSYn05haRLTL_grBDdt31ZIDnxiMFEg2UdDB1wzlJBOuOEmw",\n    "expires_in": 1800,\n    "refresh_expires_in": 1800,\n    "refresh_token":"eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJiYTcxZWMyOC0wOTVkLTRkOWQtOWQwYi1jYjAyMTJmNjczYjcifQ.eyJqdGkiOiI2YmQ2ZThkYS1kOWNjLTRhNzgtODg1NS1iMzMwZWU0NDg1NjEiLCJleHAiOjE1NTQyOTgyNTgsIm5iZiI6MCwiaWF0IjoxNTU0Mjk2NDUqsdqsdqsdqsdOiJodHRwczovL2F1dGguZGV2LWUtYXR0ZXN0YXRpb25zLmNvbS9hdXRoL3JlYWxtcy9lYXRfcmVhbG0iLCJhdWQiOiJodHRwczovL2F1dGguZGV2LWUtYXR0ZXN0YXRpb25zLmNvbS9hdXRoL3JlYWxtcy9lYXRfcmVhbG0iLCJzdWIiOiJjODQ4YWJiYi1hMjI4LTQyYzEtYWQ3MC1iMmIwMTBjOGU4NTEiLCJ0eXAiOiJSZWZyZXNoIiwiYXpwIjoiZWEtYXBpLWVkZ2UiLCJhdXRoX3RpbWUiOjAsInNlc3Npb25fc3RhdGUiOiI5YmqsdqsdsqsdQ5ZTctOTJiMC0xOTkwMGQxNWE5ZWIiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsIkFETUlOIiwiVVNFUiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoicHJvZmlsZSBlbWFpbCJ9.fpVVA-G-Fj9MDOB5ZneAGVRhkLk26hgCeZ4dqh3rEHs",\n    "token_type": "bearer",\n    "not-before-policy": 1550670103,\n    "session_state": "9ba3aaf4-3b54-49e7-92b0-19900d15a9eb",\n    "scope": "profile email"\n}\n')),Object(r.b)("p",null,"The token has a limited time which can be verified with ",Object(r.b)("inlineCode",{parentName:"p"},"expires_in")," expressed in seconds and fixed to 1800s (30 minutes)."),Object(r.b)("p",null,"Each request are authenticated with this ",Object(r.b)("inlineCode",{parentName:"p"},"access_token")," placed in a ",Object(r.b)("inlineCode",{parentName:"p"},"Authorization: bearer <your access_token>")," header for each request."),Object(r.b)("h2",{id:"environments"},"Environments"),Object(r.b)("p",null,"We provide you with a auth server per environment like so :"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"The authorization server for ",Object(r.b)("strong",{parentName:"li"},"production")," is ",Object(r.b)("inlineCode",{parentName:"li"},"https://auth.e-attestations.com")),Object(r.b)("li",{parentName:"ul"},"The authorization server for ",Object(r.b)("strong",{parentName:"li"},"testing")," is ",Object(r.b)("inlineCode",{parentName:"li"},"https://auth.test-e-attestations.com"))),Object(r.b)("h2",{id:"you-should-use-the-refresh-token-too"},"You should use the refresh token too"),Object(r.b)("p",null,"You can also ask for an renewed ",Object(r.b)("inlineCode",{parentName:"p"},"access_token")," by using the ",Object(r.b)("inlineCode",{parentName:"p"},"refresh token"),"so that you don't have to send again your credentials."),Object(r.b)("p",null,"This token is provided event quickly (les that 50ms in most cases)."),Object(r.b)("p",null,"Note that it depends on expiration (",Object(r.b)("inlineCode",{parentName:"p"},"refresh_expires_in"),") of the parent request expiration."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-txt"}),"Method: POST\nURL: https://auth.test-e-attestations.com/auth/realms/eat_realm/protocol/openid-connect/token\nBody type: x-www-form-urlencoded\nForm fields:    \nclient_id : ea-api-edge\ngrant_type : refresh_token\nrefresh_token: <your-refresh-token>\n")),Object(r.b)("h2",{id:"keep-in-mind-that-the-jwt-"},"Keep in mind that, the JWT ..."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},'is valid for a few seconds. You must make sure of the duration of validity of your TOKEN thanks to the data "expires_in" which indicates to you in number of seconds before it expires at the time of its obtaining (for example 1800 seconds corresponding to 30 \')'),Object(r.b)("li",{parentName:"ul"},"is to be used in all API requests"),Object(r.b)("li",{parentName:"ul"},"resides in the ",Object(r.b)("strong",{parentName:"li"},"access_token")," property"),Object(r.b)("li",{parentName:"ul"},"needs to be set within an ",Object(r.b)("inlineCode",{parentName:"li"},"Authorization")," HTTP Header")),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"Example")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),'curl -X GET \\\n  https://api.test-e-attestations.com/api/v1/account/97862/dossiers \\\n    -H "Authorization: Bearer <JWT_TOKEN>"\n')))}s.isMDXComponent=!0},93:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return O}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var b=i.a.createContext({}),s=function(e){var t=i.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},d=function(e){var t=s(e.components);return i.a.createElement(b.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},u=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,b=l(e,["components","mdxType","originalType","parentName"]),d=s(n),u=a,O=d["".concat(o,".").concat(u)]||d[u]||p[u]||r;return n?i.a.createElement(O,c(c({ref:t},b),{},{components:n})):i.a.createElement(O,c({ref:t},b))}));function O(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=u;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:a,o[1]=c;for(var b=2;b<r;b++)o[b]=n[b];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);